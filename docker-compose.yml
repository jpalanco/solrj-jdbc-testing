version: '2'
services:
  solr:
    image: risdenk/solrj-jdbc-testing:solr
    ports:
      - 8983
      - 9983
    volumes:
      - /opt/solr

  jisql:
    image: risdenk/solrj-jdbc-testing:jisql
    depends_on:
      - solr
    volumes_from:
      - solr:ro
    environment:
      - "JDBC=jdbc:solr://solr:9983?collection=test"
      - "QUERY=select fielda, fieldb, fieldc, fieldd_s, fielde_i from test limit 10;"

  zeppelin:
    image: risdenk/solrj-jdbc-testing:zeppelin
    ports:
      - 8080
    depends_on:
      - solr
    volumes_from:
      - solr:ro

  spark:
    image: risdenk/solrj-jdbc-testing:spark
    depends_on:
      - solr
    volumes_from:
      - solr:ro

  r-base:
    image: risdenk/solrj-jdbc-testing:r-base
    depends_on:
      - solr
    volumes_from:
      - solr:ro
    command: bash -c "Rscript /opt/scripts/test_solr.R"

  rstudio:
    image: risdenk/solrj-jdbc-testing:rstudio
    depends_on:
      - solr
    volumes_from:
      - solr:ro

  jython:
    image: risdenk/solrj-jdbc-testing:jython
    depends_on:
      - solr
    volumes_from:
      - solr:ro
    command: bash -c "/usr/local/bin/jython /opt/scripts/test_solr_zxjdbc.py"
    #command: bash -c "/usr/local/bin/jython /opt/scripts/test_solr_native.py"

  python:
    image: risdenk/solrj-jdbc-testing:python
    depends_on:
      - solr
    volumes_from:
      - solr:ro
    command: bash -c "python /opt/scripts/test_solr_jaydebeapi.py"
